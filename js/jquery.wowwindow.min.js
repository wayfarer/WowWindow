/*
 * Wowwindow, version 0.6.2 beta (2011-11-23)
 * (c) Copyright 2010 Abel Mohler
 * http://wayfarerweb.com/jquery/plugins/wowwindow/
 * Licensed under the MIT license
 * http://wayfarerweb.com/mit.php
 */
(function(f){f.fn.wowwindow=function(m){var l={testMode:false,draggable:false,fixedWindow:false,width:500,height:500,overlay:{background:"#000",opacity:0.6,zIndex:1000,fixed:true,clickToClose:true,destroyOnClose:false},before:function(){},after:function(){},onclose:function(){},zoom:true,rotate:false,rotations:1,clockwise:true,speed:800,autoplay:true,videoIframe:true,showRelated:true,autoYouTubeThumb:null,closeButton:'<a class="wowwindow-close" title="close" href="javascript:void(0)">Close</a>',wrapHTML:'<div id="wowwindow-inner"></div>',beforeHTML:'<div class="wowwindow-controlbar">{%close%} <span class="wowwindow-title">{%title%}</span></div>',afterHTML:"",verticalCenter:true,forceImageFade:false,yabbadabbadoo:false};m=m||{};if(m.overlay===false||m.overlay===null){m.overlay={};m.overlay.overlay=false}if(m.overlay){m.overlay=f.extend(l.overlay,m.overlay)}m=f.extend(l,m);m.overlay.playgroundFixed=m.fixedWindow;m.overlay.onclose=m.onclose;if(m.testMode){if(!window.console){window.console={};window.console.log=function(){}}f.fn.wowwindow.ii=0}var p=a(),j=[],i=Math.round(Math.random()*10000),k=m.clockwise?"+":"-";function n(s){if(this.title){s=s.replace(/\{\%title\%\}/,this.title)}else{if(f(this).find("img").length==1&&f(this).find("*").length==1){var q=f(this).find("img")[0];var r=q.alt||"";s=s.replace(/\{\%title\%\}/,r)}else{s=s.replace(/\{\%title\%\}/,"")}}var o=m.closeButton||"";s=s.replace(/\{\%close\%\}/,o);return s}return this.each(function(){var q=this;this.open=false;var o=(m.closeButton)?f(m.closeButton):f("<span></span>");if(m.closeButton){o.click(function(){f(document.body).overlayPlayground("close");q.open=false})}if(f(this).attr("href").match(/\/\/www\.youtube\.com\/watch\?/)&&m.autoYouTubeThumb&&f(this).find(">img").length>0){var r=(document.location.protocol=="https:")?"https://":"http://";f(this).find(">img").eq(0).attr("src",r+"img.youtube.com/vi/"+this.href.split("v=")[1].split("&")[0]+"/"+m.autoYouTubeThumb+".jpg")}f(this).click(function(t){t.preventDefault();var D=this,v=f(this).attr("href").slice(-4);var u=(v==".jpg"||v==".png"||v==".gif"||v==".bmp");var A=false;if(f(this).attr("href").indexOf("#")===0){m.overlay.html='<div id="wowwindow">'+n.call(this,f(f(this).attr("href")).html())+"</div>"}else{if(u){if(j[this.href]&&!m.forceImageFade){m.overlay.html='<div id="wowwindow"><div id="wowwindow-image"><img src="'+this.href+"?"+i+'"></div></div>'}else{m.overlay.html='<div id="wowwindow"><div id="wowwindow-image"><div id="wowwindow-image-loading">&nbsp;</div></div></div>'}}else{A=true;var I="",y;if(this.href.match(/\/\/www\.youtube\.com\/watch\?/)){I="youtube";y=this.href.split("v=")[1].split("&")[0]}else{if(this.href.match(/\/\/vimeo\.com\/([0-9]+)$/)||this.href.match(/\/\/www\.vimeo\.com\/([0-9]+)$/)){I="vimeo";y=this.href.split("//")[1].split("/")[1]}}m.overlay.html='<div id="wowwindow-image"><div id="wowwindow-image-loading">&nbsp;</div></div>';m.overlay.html='<div id="wowwindow">'+m.overlay.html+"</div>"}}if(typeof m.before=="function"){m.before.call(this)}if(A&&I!=""){m.overlay.onclose=function(){f("#wowwindow iframe, #wowwindow-video-flash").remove();if(typeof m.onclose=="function"){m.onclose.call(this)}}}f(document.body).overlayPlayground(m.overlay);f("#wowwindow")[0].self=q;if(A){var s=this.href,F="";switch(I){case"youtube":s="//www.youtube.com/embed/"+y+"?rel="+(m.showRelated?"1":"0")+(m.autoplay?"&autoplay=1":"");F="wowwindow-video wowwindow-video-youtube";if(!m.videoIframe){f('<div id="wowwindow-video-flash"><object width="'+m.width+'" height="'+m.height+'"><param name="movie" value="http://www.youtube.com/v/'+y+"?fs=1&rel="+(m.showRelated?"1":"0")+(m.autoplay?"&autoplay=1":"")+'"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/'+y+"?fs=1&rel="+(m.showRelated?"1":"0")+(m.autoplay?"&autoplay=1":"")+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="'+m.width+'" height="'+m.height+'"></embed></object></div>').appendTo("#wowwindow")}break;case"vimeo":s="http://player.vimeo.com/video/"+y+"?title=0&byline=0&portrait=0"+(m.autoplay?"&autoplay=1":"");F="wowwindow-video wowwindow-video-vimeo";if(!m.videoIframe){f('<div id="wowwindow-video-flash"><object width="'+m.width+'" height="'+m.height+'"><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="http://vimeo.com/moogaloop.swf?clip_id='+y+"&server=vimeo.com&show_title=0&show_byline=0&show_portrait=0&color=00adef&fullscreen=1"+(m.autoplay?"&autoplay=1":"&autoplay=0")+'&loop=0" /><embed src="http://vimeo.com/moogaloop.swf?clip_id='+y+"&server=vimeo.com&show_title=0&show_byline=0&show_portrait=0&color=00adef&fullscreen=1"+(m.autoplay?"&autoplay=1":"&autoplay=0")+'&loop=0" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="'+m.width+'" height="'+m.height+'"></embed></object></div>').appendTo("#wowwindow")}break}if(I==""||m.videoIframe){f(document.createElement("iframe")).attr({id:"wowwindow-iframe",className:F,src:s,height:m.height,width:m.width,type:"text/html",frameBorder:"0"}).css({display:"none"}).load(function(){f(this).fadeIn(300,function(){if(I=="youtube"){f(this).parent().html(f(this).parent().html())}})}).appendTo("#wowwindow")}}if(!m.fixedWindow){f("body > .overlayPlaygroundPlayground").css({top:f(window).scrollTop()+"px"})}f("#wowwindow").click(function(){f.fn.wowwindow.overLayClickDefault=false});if(m.overlay.clickToClose&&!f.fn.wowwindow.overLayClickEventSet){f(document.body).click(function(){if(f.fn.wowwindow.overLayClickDefault&&f("#wowwindow")[0].self.open){f(document.body).overlayPlayground("close");q.open=false;f("#wowwindow")[0].self=q}f.fn.wowwindow.overLayClickDefault=true});f.fn.wowwindow.overLayClickEventSet=true}f("#wowwindow >*").wrapAll(m.wrapHTML);f("#wowwindow").prepend(n.call(this,m.beforeHTML));f("#wowwindow").append(n.call(this,m.afterHTML));q.open=true;f("#wowwindow .wowwindow-close").click(function(){if(q.open){f(document.body).overlayPlayground("close");q.open=false}return false});if(A){f("#wowwindow-iframe").parent().height(m.height)}if(m.zoom){f("#wowwindow").scale(0)}if(A){f("#wowwindow").width(m.width+20)}else{if(!u){f("#wowwindow").width(m.width)}else{var z=m.forceImageFade;if(f("#wowwindow-image-loading").length==1||m.forceImageFade){f("#wowwindow").width(f("#wowwindow-image-loading").width()+20);f("#wowwindow-image-loading").parent().height(f("#wowwindow-image-loading").height());z=true}else{var x=f("#wowwindow-image img").width();var H=f("#wowwindow-image img").height();if(m.testMode){f.fn.wowwindow.ii+=1;console.log("!"+f.fn.wowwindow.ii+". "+x+","+H)}if(x){f("#wowwindow").width(x+20)}}}}function E(){f("#wowwindow")[0].style.MozTransform="none";f("#wowwindow")[0].style.WebkitTransform="none";f("#wowwindow")[0].style.transform="none"}function G(){if(!m.draggable||f("#wowwindow .wowwindow-controlbar").length==0){return}var O=true,L,K,J,N,M=false;f("#wowwindow .wowwindow-controlbar").mousedown(function(P){if(O){L=P.pageX;K=P.pageY;if(f("#wowwindow")[0].style.top&&f("#wowwindow")[0].style.left){J=Math.round(parseFloat(f("#wowwindow").css("left").replace(/px/,"")));N=Math.round(parseFloat(f("#wowwindow").css("top").replace(/px/,"")))}else{J=Math.round(f("body > .overlayPlaygroundPlayground").width()/2);N=Math.round(f("body > .overlayPlaygroundPlayground").height()/2)}M=true}O=true});f("#wowwindow .wowwindow-controlbar .wowwindow-close").mousedown(function(){O=false});f(document.body).mousemove(function(T){if(M){var S=T.pageX-L,R=T.pageY-K,Q=J+S,P=N+R;f("#wowwindow").css({left:Q+"px",top:P+"px"})}});f(window).mouseup(function(){M=false});f("#wowwindow .wowwindow-controlbar").mouseup(function(){M=false})}function C(){if(m.zoom){f(document.body).overlayPlayground("open");f("#wowwindow").animate({scale:"+=1.00"},{queue:false,duration:m.speed,complete:function(){if(p){E();if(typeof m.after=="function"){m.after.call(D)}G.call(this)}}})}else{f(document.body).overlayPlayground("open")}if(m.rotate){f("#wowwindow").animate({rotate:k+"="+(360*m.rotations)+"deg"},{queue:false,duration:m.speed,complete:function(){if(p&&!m.zoom){E();if(!m.zoom&&typeof m.after=="function"){m.after.call(D)}G.call(this)}}})}f("#wowwindow").css({marginTop:"-"+(f("#wowwindow").outerHeight()/2)+"px",marginLeft:"-"+(f("#wowwindow").outerWidth()/2)+"px"});if(p){f("#wowwindow").css({left:t.clientX+"px",top:t.clientY+"px"}).animate({left:(f("body > .overlayPlaygroundPlayground").width()/2)+"px",top:(f("body > .overlayPlaygroundPlayground").height()/2)+"px"},m.speed)}}if(!u||x||z){C.call(this)}else{var w=setInterval(function(){var K=f("#wowwindow-image img").width();var J=f("#wowwindow-image img").height();if(m.testMode){f.fn.wowwindow.ii+=1;console.log("!"+f.fn.wowwindow.ii+". "+K+","+J)}if(K){f("#wowwindow").width(K+20);C.call(D);clearInterval(w)}},1)}if(z){var B=new Image();f(B).attr({id:"wowwindow-loaded-image",src:f(D).attr("href")+"?"+i}).css({position:"absolute",top:"-999em",bottom:"-999em"});f(B).load(function(){var J=this;f(this).appendTo("#wowwindow-image");var K=setInterval(function(){var L=f(J).height();var M=f(J).width();if(m.testMode){f.fn.wowwindow.ii+=1;console.log(f.fn.wowwindow.ii+". "+M+","+L)}if(M){f("#wowwindow").animate({width:(M+20)+"px",marginTop:"-"+((L+20)/2)+"px",marginLeft:"-"+((M+20)/2)+"px"},{queue:m.yabbadabbadoo,duration:300,complete:function(){f("#wowwindow-loaded-image").css({top:"10px",left:"10px",display:"none"}).fadeIn(300)}});f("#wowwindow-loaded-image").parent().animate({height:L+"px"});f(B).unbind("load");clearInterval(K)}},1);j[D.href]=true})}if(!m.zoom&&!m.rotate&&p&&typeof m.after=="function"){E();m.after.call(this);G.call(this)}if(!p&&typeof m.after=="function"){E();m.after.call(this);G.call(this)}return false})})};f.wowwindow={close:function(){var i=f("#wowwindow");if(i.length>0&&i[0].self.open){f(document.body).overlayPlayground("close");f("#wowwindow")[0].self.open=false}}};f.fn.wowWindow=f.fn.WowWindow=f.fn.wowwindow;f.wowWindow=f.WowWindow=f.wowwindow;f.fn.wowwindow.overLayClickEventSet=false;f.fn.wowwindow.overLayClickDefault=true;f.fn.overlayPlayground=function(l){var k={background:"#000",opacity:0.75,zIndex:1000,fixed:true,playgroundFixed:false,html:"",overlay:true,open:true,destroyOnClose:false,onclose:null};var i=true;if(l=="close"){l={open:false}}if(l=="open"){l={open:true};i=false}l=f.extend(k,l);if(typeof l.onclose=="function"){f.fn.overlayPlayground.onclose=l.onclose}else{if(typeof f.fn.overlayPlayground.onclose=="function"){l.onclose=f.fn.overlayPlayground.onclose}}var j=(typeof document.body.style.maxWidth=="undefined")?true:false;return this.each(function(){if(l.open){var o=false;if(f(this).find("> .overlayPlaygroundOverlay, > .overlayPlaygroundPlayground").length>0){o=true;f(this).find("> .overlayPlaygroundOverlay, > .overlayPlaygroundPlayground").show()}f("html,body").css({height:"100%"});if(!i){return}if(l.overlay){var p={opacity:l.opacity,filter:"alpha(opacity="+(l.opacity*100)+")",background:l.background,zIndex:l.zIndex,padding:0,margin:0,height:f(document).height()+"px",width:"100%",left:0,top:0,position:"absolute"};if(o){f(this).find("> .overlayPlaygroundOverlay").css(p)}else{f('<div class="overlayPlaygroundOverlay">&nbsp;</div>').css(p).appendTo(this)}}var m={zIndex:l.zIndex+10,padding:0,margin:0,height:"100%",width:"100%",left:0,top:0,position:(j||!l.playgroundFixed)?"absolute":"fixed"};if(o){f(this).find("> .overlayPlaygroundPlayground").css(m).html(l.html)}else{f('<div class="overlayPlaygroundPlayground"></div>').css(m).html(l.html).appendTo(this);if(j&&l.playgroundFixed){var n=this;f(window).scroll(function(){f(n).find("> .overlayPlaygroundPlayground").css("top",f(window).scrollTop()+"px")});f(window).scroll()}}}else{if(!l.destroyOnClose){f(this).find(".overlayPlaygroundOverlay,.overlayPlaygroundPlayground").hide()}else{f(this).find(".overlayPlaygroundOverlay,.overlayPlaygroundPlayground").remove()}if(typeof l.onclose=="function"){l.onclose.call(this)}}})};function a(){var i=["transform","WebkitTransform","MozTransform","msTransform","OTransform"],j;while(j=i.shift()){if(typeof document.body.style[j]!="undefined"){return true}}return false}function h(j){var i=["transform","WebkitTransform","msTransform","MozTransform","OTransform"];var k;while(k=i.shift()){if(typeof j.style[k]!="undefined"){return k}}return"transform"}var g=null;var d=f.fn.css;f.fn.css=function(i,j){if(g===null){if(typeof f.cssProps!="undefined"){g=f.cssProps}else{if(typeof f.props!="undefined"){g=f.props}else{g={}}}}if(typeof g.transform=="undefined"&&(i=="transform"||(typeof i=="object"&&typeof i.transform!="undefined"))){g.transform=h(this.get(0))}if(g.transform!="transform"){if(i=="transform"){i=g.transform;if(typeof j=="undefined"&&jQuery.style){return jQuery.style(this.get(0),i)}}else{if(typeof i=="object"&&typeof i.transform!="undefined"){i[g.transform]=i.transform;delete i.transform}}}return d.apply(this,arguments)};var e="deg";f.fn.rotate=function(k){var j=f(this).css("transform")||"none";if(typeof j=="undefined"){return this}if(typeof k=="undefined"){if(j){var i=j.match(/rotate\(([^)]+)\)/);if(i&&i[1]){return i[1]}}return 0}var i=k.toString().match(/^(-?\d+(\.\d+)?)(.+)?$/);if(i){if(i[3]){e=i[3]}f(this).css("transform",j.replace(/none|rotate\([^)]*\)/,"")+"rotate("+i[1]+e+")")}return this};f.fn.scale=function(n,l,j){var k=f(this).css("transform");if(typeof k=="undefined"){return this}if(typeof n=="undefined"){if(k){var i=k.match(/scale\(([^)]+)\)/);if(i&&i[1]){return i[1]}}return 1}f(this).css("transform",k.replace(/none|scale\([^)]*\)/,"")+"scale("+n+")");return this};var c=f.fx.prototype.cur;f.fx.prototype.cur=function(){if(this.prop=="rotate"){return parseFloat(f(this.elem).rotate())}else{if(this.prop=="scale"){return parseFloat(f(this.elem).scale())}}return c.apply(this,arguments)};f.fx.step.rotate=function(i){f(i.elem).rotate(i.now+e)};f.fx.step.scale=function(i){f(i.elem).scale(i.now)};var b=f.fn.animate;f.fn.animate=function(j){if(typeof j!="undefined"&&typeof j.rotate!="undefined"){var i=j.rotate.toString().match(/^(([+-]=)?(-?\d+(\.\d+)?))(.+)?$/);if(i&&i[5]){e=i[5]}j.rotate=i[1]}return b.apply(this,arguments)}})(jQuery);